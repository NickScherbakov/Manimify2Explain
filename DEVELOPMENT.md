# Процесс разработки Manimify2Explain

## Введение

Данный документ содержит описание процесса разработки проекта **Manimify2Explain** — инструмента для автоматического преобразования PDF-документов в анимированные презентации с использованием библиотеки Manim. Как главный двигатель и архитектор НАШЕГО проекта, я расскажу о концепции, архитектурных решениях, взаимодействии компонентов и путях дальнейшего развития.

## Концепция и идея

Основная идея Manimify2Explain возникла из потребности превращать статичные, часто сложные для восприятия текстовые материалы (учебники, научные статьи, техническую документацию) в наглядные и динамические визуализации. 

Ключевые принципы, положенные в основу проекта:

1. **Автоматизация** — минимальное участие пользователя в процессе преобразования
2. **Интеллектуальный анализ** — выделение ключевых элементов из документа (текст, таблицы, графики)
3. **Динамическая визуализация** — представление извлеченной информации в виде анимаций
4. **Модульность** — разделение функциональности на независимые компоненты для облегчения поддержки и расширения

## Архитектура проекта

Проект построен по модульному принципу, где каждый модуль отвечает за определённую часть процесса преобразования:

1. **pdf_extractor.py** — извлечение текста и изображений из PDF-файлов
2. **table_processor.py** — обнаружение и обработка таблиц
3. **graph_processor.py** — анализ графических элементов и построение структур графов
4. **manim_script_generator.py** — генерация скриптов для библиотеки Manim
5. **main.py** — объединение всех компонентов в единый пайплайн

### Схема взаимодействия модулей

```
PDF-файл → pdf_extractor → Текст + Изображения → 
                                   ↓
              graph_processor ← Изображения → table_processor
                       ↓                           ↓
                    Графы                      Таблицы
                       ↓                           ↓
                         → manim_script_generator ←
                                    ↓
                         Скрипт для Manim (.py)
                                    ↓
                        Анимированная презентация
```

## Процесс реализации

### 1. Модуль извлечения данных из PDF (pdf_extractor.py)

Для извлечения содержимого из PDF-файлов я выбрал библиотеку PyMuPDF (fitz), так как она обеспечивает:
- Высокую производительность
- Поддержку различных форматов PDF
- Простоту использования для извлечения текста и изображений

Модуль предоставляет две основные функции:
- `extract_text(pdf_path)` — извлекает текст из всех страниц PDF
- `extract_images(pdf_path)` — извлекает все изображения с сохранением метаданных

### 2. Модуль обработки таблиц (table_processor.py)

Для распознавания и обработки таблиц я использовал комбинацию OpenCV и pytesseract:

1. OpenCV применяется для:
   - Предварительной обработки изображений (приведение к оттенкам серого, бинаризация)
   - Обнаружения линий таблицы с помощью морфологических операций
   - Определения структуры таблицы через анализ контуров

2. Pytesseract используется для:
   - OCR (оптического распознавания символов) в ячейках таблиц
   
Основные функции модуля:
- `detect_table(image)` — определяет, содержит ли изображение таблицу
- `ocr_table(image)` — извлекает текст из изображения с таблицей

### 3. Модуль обработки графиков и диаграмм (graph_processor.py)

Для анализа изображений с графами и диаграммами я реализовал:

1. Алгоритм обнаружения структурных элементов графа:
   - Преобразование изображения в бинарный формат
   - Выделение контуров и фильтрация по размеру
   - Определение центров контуров как узлов графа

2. Создание структуры графа с помощью NetworkX:
   - Добавление узлов с координатами
   - Автоматическое определение связей между узлами на основе расстояния

Основные функции:
- `is_graph_image(image)` — определяет, является ли изображение графом/диаграммой
- `extract_graph_structure(image)` — преобразует изображение в структуру NetworkX

### 4. Модуль генерации Manim-скриптов (manim_script_generator.py)

Этот модуль преобразует извлеченные данные в Python-скрипт для библиотеки Manim:

1. Для текста:
   - Создание объекта Text с извлеченным содержимым
   - Добавление анимации Write для появления текста

2. Для таблиц:
   - Представление содержимого таблицы в текстовом виде
   - Расположение под основным текстом

3. Для графов:
   - Преобразование структуры NetworkX в формат, понятный Manim
   - Создание объекта Graph с настроенными узлами и рёбрами
   - Добавление анимации Create для визуализации графа

Основная функция:
- `generate_manim_script(text, table_text, graph)` — генерирует Python-скрипт для Manim

### 5. Главный модуль (main.py)

Модуль `main.py` объединяет все компоненты в единый пайплайн:

1. Извлечение текста и изображений из PDF-файла
2. Обработка каждого изображения:
   - Проверка, является ли изображение таблицей
   - Если да — извлечение текста с помощью OCR
   - Если нет — проверка, является ли изображение графом
   - Если да — извлечение структуры графа
3. Накопление извлеченных данных
4. Генерация Manim-скрипта
5. Вывод инструкций по запуску сгенерированной анимации

## Взаимодействие с сервисами

Проект использует несколько внешних библиотек и сервисов:

1. **PyMuPDF (fitz)** — для работы с PDF-документами
2. **OpenCV** — для обработки изображений
3. **Pytesseract** — для оптического распознавания символов (требует установленного Tesseract OCR)
4. **NetworkX** — для работы с графовыми структурами
5. **Manim** — для создания анимаций

Последовательность взаимодействия:
1. PDF-документ загружается через PyMuPDF
2. Извлеченные изображения обрабатываются через OpenCV
3. Текст из таблиц распознается с помощью Pytesseract
4. Графы моделируются через NetworkX
5. Результирующий скрипт использует Manim для создания анимации

## Инструкция для дальнейшего развития проекта

Если вы хотите развивать Manimify2Explain, вот несколько направлений и рекомендаций:

### 1. Улучшение обработки сложных документов

- **Распознавание формул** — добавьте модуль для распознавания и анимации математических формул, например, с использованием библиотек типа `sympy` или `latexocr`
- **Обработка многостраничных документов** — реализуйте интеллектуальное разделение контента на несколько сцен Manim
- **Поддержка разных языков** — улучшите модуль OCR для корректной работы с разными языками

### 2. Расширение возможностей визуализации

- **Создание шаблонов анимаций** — добавьте набор готовых шаблонов для разных типов содержимого
- **3D-визуализация** — расширьте функционал для создания трехмерных анимаций
- **Интерактивные элементы** — добавьте возможность экспорта в интерактивные форматы

### 3. Улучшение интерфейса

- **Веб-интерфейс** — создайте веб-приложение для загрузки PDF и получения анимаций
- **GUI** — разработайте графический интерфейс с использованием Qt или другой библиотеки
- **CLI с расширенными возможностями** — добавьте поддержку пакетной обработки и конфигурационных файлов

### 4. Оптимизация и масштабирование

- **Параллельная обработка** — реализуйте многопоточность для ускорения обработки больших документов
- **Кэширование** — добавьте систему кэширования промежуточных результатов
- **Распределенная обработка** — реализуйте поддержку распределенных вычислений для крупных наборов документов

### 5. Интеграция с AI-инструментами

- **Суммаризация текста** — используйте NLP-модели для автоматического выделения ключевых моментов
- **Классификация изображений** — применяйте более продвинутые методы компьютерного зрения
- **Генерация пояснений** — используйте генеративные модели для создания дополнительных пояснений

## Практические советы по разработке

1. **Модульное тестирование** — создайте тесты для каждого модуля отдельно:
   ```python
   # Пример теста для pdf_extractor.py
   import unittest
   from pdf_extractor import extract_text
   
   class TestPDFExtractor(unittest.TestCase):
       def test_extract_text(self):
           # Реализация теста
   ```

2. **Управление зависимостями** — используйте виртуальные окружения и указывайте версии пакетов:
   ```bash
   python -m venv venv
   source venv/bin/activate  # или venv\Scripts\activate на Windows
   pip install -r requirements.txt
   ```

3. **Логирование** — добавьте систему логирования для отслеживания процесса обработки:
   ```python
   import logging
   
   logging.basicConfig(level=logging.INFO)
   logger = logging.getLogger(__name__)
   
   def process_document(path):
       logger.info(f"Начало обработки документа: {path}")
       # Код обработки
   ```

4. **Контроль версий** — используйте осмысленные коммиты и ветки:
   ```bash
   git checkout -b feature/formula-recognition
   # Реализация функциональности
   git commit -m "Add formula recognition using latexocr"
   ```

## Заключение

Проект Manimify2Explain представляет собой модульную систему для автоматического преобразования статичных PDF-документов в динамические анимированные презентации. Архитектура проекта обеспечивает гибкость и расширяемость, что позволяет легко добавлять новые функции и улучшать существующие.

Я надеюсь, что эта документация поможет вам понять структуру проекта и внести свой вклад в его развитие. Если у вас возникнут вопросы или предложения, не стесняйтесь открывать issues или pull requests в репозитории проекта.

---

*Документ создан: Апрель 2025*
