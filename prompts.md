# Prompts for GitHub Copilot for Manimify2Explain

Этот файл содержит подробные инструкции для GitHub Copilot по разработке проекта **Manimify2Explain**. Наш проект предназначен для автоматизации преобразования PDF-документов (учебников, конспектов и технических материалов) в анимированные сцены с использованием библиотеки Manim. Ниже приведены пошаговые указания для генерации каждого модуля.

---

## 1. Модуль PDF-извлечения (`pdf_extractor.py`)

**Задача:**  
Создать модуль для извлечения текста и изображений из PDF-файлов с помощью библиотеки PyMuPDF.

**Инструкции для Copilot:**
- Импортируйте библиотеку `fitz` (PyMuPDF).
- Определите функцию `extract_text(pdf_path: str) -> str`:
  - Откройте PDF-файл.
  - Пройдитесь по всем страницам, извлекая текст с каждой страницы.
  - Объедините и верните полученный текст как одну строку.
- Определите функцию `extract_images(pdf_path: str) -> list`:
  - Откройте PDF-файл.
  - Для каждой страницы найдите изображения (используйте метод `page.get_images(full=True)`).
  - Извлеките каждое изображение (с помощью `doc.extract_image(xref)`) и сохраните его в список.
  - Верните список изображений (в формате байтов).

**Пример запроса Copilot:**
```
Напиши модуль pdf_extractor.py, использующий PyMuPDF. Он должен содержать функции:
- extract_text(pdf_path: str) -> str: открывает PDF, извлекает текст со всех страниц и объединяет его.
- extract_images(pdf_path: str) -> list: проходит по всем страницам, извлекает изображения и возвращает их список.
Не забудь добавить необходимые комментарии и docstrings.
```

---

## 2. Модуль обработки таблиц (`table_processor.py`)

**Задача:**  
Создать модуль, который с помощью OpenCV и pytesseract обрабатывает изображения для извлечения текста из таблиц.

**Инструкции для Copilot:**
- Импортируйте библиотеки `cv2` и `pytesseract`.
- Определите функцию `ocr_table(image)`:
  - Преобразуйте входное изображение в оттенки серого.
  - Примените бинаризацию (например, с пороговым значением 150) для улучшения качества OCR.
  - Используйте pytesseract с конфигурацией (например, `--oem 3 --psm 6`) для извлечения текста.
  - Верните извлечённый текст.

**Пример запроса Copilot:**
```
Напиши модуль table_processor.py с функцией ocr_table(image), которая:
- Принимает изображение (numpy array).
- Преобразует изображение в серый формат.
- Применяет бинаризацию с порогом 150.
- Использует pytesseract с конфигом --oem 3 --psm 6.
- Возвращает извлечённый текст.
```

---

## 3. Модуль обработки графов (`graph_processor.py`)

**Задача:**  
Разработать модуль для анализа изображений, содержащих графы или диаграммы, и преобразования их в структуры данных с помощью NetworkX.

**Инструкции для Copilot:**
- Импортируйте `cv2` и `networkx` (как nx).
- Определите функцию `extract_graph_structure(image)`:
  - Преобразуйте изображение в серый формат и примените бинаризацию.
  - Найдите контуры с помощью `cv2.findContours`.
  - Фильтруйте контуры по площади (например, оставляйте только те, у которых площадь больше 100).
  - Для каждого значимого контура рассчитайте его центр (например, используя моменты).
  - Создайте объект графа через `nx.Graph()` и добавьте узлы с координатами.
  - Верните полученный граф.

**Пример запроса Copilot:**
```
Напиши модуль graph_processor.py с функцией extract_graph_structure(image), которая:
- Конвертирует изображение в серый формат.
- Применяет бинаризацию.
- Находит контуры с помощью cv2.findContours.
- Отфильтровывает мелкие контуры (площадь меньше 100).
- Вычисляет центр каждого значимого контура.
- Создает NetworkX граф и добавляет узлы с координатами центра.
- Возвращает объект графа.
```

---

## 4. Модуль генерации Manim-скриптов (`manim_script_generator.py`)

**Задача:**  
Создать модуль, который генерирует Python-скрипт для Manim на основе извлечённого текста, данных таблиц и графа.

**Инструкции для Copilot:**
- Определите функцию `generate_manim_script(text: str, table_text: str, graph) -> None`.
- Начните сбор строки скрипта, добавив импорт `from manim import *`.
- Определите класс `AutoScene(Scene)` c методом `construct`.
- Если текст (text) присутствует, добавьте создание объекта `Text` для отображения текста и анимацию его появления.
- Если присутствует `table_text`, добавьте аналогичный объект для таблицы.
- Если имеется граф (и он содержит узлы), создайте словарь позиций узлов и используйте класс `Graph` из Manim для визуализации.
- Запишите собранные строки в файл `generated_manim_scene.py`.

**Пример запроса Copilot:**
```
Напиши модуль manim_script_generator.py с функцией generate_manim_script(text: str, table_text: str, graph) -> None, которая:
- Формирует список строк с кодом Manim-скрипта.
- Включает импорт from manim import *
- Определяет класс AutoScene(Scene) с методом construct, который:
  - Если задан text, создает объект Text и анимирует его появление.
  - Если задан table_text, создает и анимирует текстовый объект.
  - Если граф доступен, создает словарь позиций узлов и генерирует объект Graph.
- Записывает итоговый код в файл generated_manim_scene.py.
Не забудь добавить необходимые комментарии.
```

---

## 5. Главный модуль (`main.py`)

**Задача:**  
Создать модуль, который объединяет все остальные компоненты и реализует общий пайплайн обработки PDF и генерации Manim-сцены.

**Инструкции для Copilot:**
- Импортируйте функции из `pdf_extractor.py`, `table_processor.py`, `graph_processor.py` и `manim_script_generator.py`.
- Определите функцию `main(pdf_path: str)`:
  - Извлеките текст и изображения из PDF, используя функции из модуля pdf_extractor.
  - Для каждого изображения:
    - Преобразуйте байты в изображение с помощью OpenCV.
    - Запустите OCR через функцию ocr_table для обнаружения таблиц.
    - Анализируйте изображение через extract_graph_structure для получения графовой структуры.
    - Накопите результат (например, конкатенация текста таблиц, выбор одного подходящего графа).
  - Вызовите функцию generate_manim_script с накопленными данными.
- Обеспечьте обработку ошибок и напишите понятные комментарии для пояснения каждого шага.

**Пример запроса Copilot:**
```
Напиши файл main.py, который:
- Импортирует extract_text и extract_images из pdf_extractor.py,
- Импортирует ocr_table из table_processor.py,
- Импортирует extract_graph_structure из graph_processor.py,
- Импортирует generate_manim_script из manim_script_generator.py,
- Определяет функцию main(pdf_path: str), которая:
   - Извлекает текст и изображения из PDF,
   - Для каждого изображения конвертирует байты в cv2-изображение,
   - Выполняет ocr_table и extract_graph_structure,
   - Накопляет полученные данные,
   - Вызывает generate_manim_script с извлечённым текстом, таблицами и графом.
Не забудь добавить комментарии и обработку ошибок.
```

---

## 6. Дополнительная интеграция с cline-yandex (опционально)

**Задача:**  
При желании расширить интерфейс проекта, добавьте модуль или расширьте main.py для интеграции с функционалом cline-yandex — это позволит управлять проектом через интерактивный CLI.

**Инструкции для Copilot:**
- Проанализируйте возможности cline-yandex, такие как запуск собственных команд, редактирование файлов и мониторинг процесса.
- Добавьте функциональность, позволяющую:
  - Инициализировать CLI-сессию,
  - Предоставить набор команд для запуска этапов процесса (например, извлечения данных, генерации скрипта, тестирования),
  - Отображать сообщения об ошибках и логах в режиме реального времени.
- Документируйте, как использовать расширенные возможности CLI.

**Пример запроса Copilot:**
```
Напиши дополнительный модуль или расширь main.py для интеграции с cline-yandex, чтобы:
- Инициализировать CLI-сессию,
- Предоставлять команды для управления процессом (например, запуск извлечения, просмотр логов),
- Выводить подсказки и логи,
- Документировать, как использовать эти команды.
```

---

## Итоговые рекомендации

- **Документация и комментарии:**  
  Во всех модулях используйте понятные docstrings и комментарии для облегчения сопровождения кода.

- **Обработка ошибок:**  
  Добавьте необходимую обработку исключений, чтобы пользователь получил информативные сообщения при возникновении ошибок.

- **Тестирование:**  
  Создайте тесты для ключевых функций, чтобы убедиться, что модули работают корректно при разных входных данных.

- **Единый стиль кода:**  
  Все файлы должны придерживаться единого стиля кодирования (например, PEP8) для повышения читаемости и удобства поддержки.